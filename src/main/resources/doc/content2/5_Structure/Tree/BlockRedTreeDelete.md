### 红黑树(-):删除

> 上一节讲解了如何构造红黑树，那么今天看一下红黑树的删除操作。

红黑树的删除操作比插入操作要更为复杂，因为需要考虑因素比插入要多。

对于一个节点的删除，我们可以从如下两个方面去考虑：

一.删除节点的颜色

二.删除节点的构造

颜色上，节点有红黑两种可能

而构造上，节点有三种可能：其一是节点的孩子都为Nil，其二是一个节点为Nil，其三是两个节点都不为Nil。
而如果两个节点都不为Nil，那么我们就需要找替代节点(后继结点)来替代删除，而替代结点就会是情况一和情况二。

后继结点的判断可以使用下图的方式，将节点Key落入X轴中(实质是中序排序)其后一个结点就是后继节点。
后继节点替代删除的方案，比如删除-1，那么可以将0替换到-1的位置，然后删除0，这样就会到情况一，
再比如删除4，那么使用5来代替，然后删除5，这样就回到了情况二。

![image](https://p3.pstatp.com/origin/pgc-image/1040631a5fae44e8bf2fd3dc191d2656)

那么现在我们正式开始分析删除所出现的可能情况。

情况一.删除节点存在一个孩子，那么此时，不需要考虑节点的颜色，因为该节点必然为黑色
(因为如果结点为红色，那么两个孩子结点只会都为Nil，或者都为黑色，否则无法保证平衡，
任意节点到叶子结点经过相同的黑色节点)。如下：

![image](https://p3.pstatp.com/origin/pgc-image/0cef8e07946e4da5a5ded7d0e445791a)

这种情况处理较为简单，只需要将节点P的指针指向DL或者DR，然后将DL或者DR的颜色变更为黑色，
就保证了红黑树的平衡，如下：

![image](https://p3.pstatp.com/origin/pgc-image/683a493315954a9785a6c7fa8eb633d6)

上述情况需要注意当D是根节点时，删除操作之后，孩子节点会成为新的根节点

情况二.删除节点不存在孩子，那么此时就需要考虑节点的颜色。如果为红色，那么直接删除即可，
但是如果为黑色，那么需要考虑的因素更多。

首先我们考虑为红色这种最简单的情况，这种情况，P节点断掉指向节点D的指针指向就好了

![image](https://p3.pstatp.com/origin/pgc-image/82191320a1904b07b98f50dbd2dfc916)

然后我们考虑黑色，这种情况较为复杂，因为黑色节点被删除之后，红黑树会失去平衡，此时需要调整平衡。
那么可能的情况有如下几种

第一种：父节点为红色。此时情况稍微好处理，因为将父节点变为黑色，兄弟节点变为红色，即可
保证红黑树平衡
(兄弟节点必然存在，且为黑色)

![image](https://p3.pstatp.com/origin/pgc-image/b1df2e6c452a45bf83295ee0d535444d)


情况2.2.2：父节点为红色，兄弟节点存在孩子，此时无法向情况2.2.1那么处理，因为兄弟节点存在的孩子必然为红色​

![image](https://p3.pstatp.com/origin/pgc-image/9651c91d60d9458e96f55956232fa560)

第二种：父节点为黑色，那么此时删除节点D，无法通过修改父节点颜色来调整红黑树平衡，就需要
我们进行旋转操作，来调整平衡，那么此时共有如下几种可能(以删除结点在左侧为例):

1> 兄弟结点存在孩子结点

1.1> 左孩子存在(不为Nil)，需要两次调整实现红黑树平衡

![iamge](https://p3.pstatp.com/origin/pgc-image/cca61500997d4a18a4f338f33983e701)

1.2> 左孩子为Nil，右孩子不为Nil，此时通过一次旋转即可平衡

![image](https://p3.pstatp.com/origin/pgc-image/6d893d8685b64b9fbbfa1c002e7b4764)

2> 兄弟结点不存在孩子结点，此时无法通过旋转来实现平衡，即P节点无法继续调整，那么就D设置为
红色，保证P这个子树平衡，然后通过P节点，向上递归，然后就会回归到情况二，
即如果P的父结点为红色就是(情况二的第一种情况)，如果为黑(情况二的第二种情况)。

![image](https://p3.pstatp.com/origin/pgc-image/f011f7e6cf5c440a926b6dd8c3032f2d)

